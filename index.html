<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Draw with friends</title>
    <style>
      #myCanvas {
        overflow: scroll;
        cursor: crosshair;
      }
    </style>
  </head>
  <body>
    <nav>
      <ul style="display: flex; gap: 1rem; list-style: none">
        <li>Tools:</li>
        <li id="brush" onclick="changeTool('brush')">Brush (default)</li>
        <li id="eraser" onclick="changeTool('eraser')">Eraser</li>
        <li id="clear">Press 'c' to clear the canvas</li>
      </ul>
    </nav>
    <canvas id="myCanvas"></canvas>
    <script>
      /**
       * @constant
       * @type {HTMLCanvasElement}
       */
      const canvas = document.getElementById("myCanvas");
      const ctx = canvas.getContext("2d");

      const tools = [
        {
          name: "brush",
          icon: "🖌️",
        },
        {
          name: "eraser",
          icon: "🩹",
        },
      ];

      const localState = {
        lastX: 0,
        lastY: 0,
        isDrawing: false,
        currentTool: tools[0].name,
      };

      const canvasConfig = {
        width: 2560,
        height: 630,
      };

      const drawConfig = {
        strokeStyle: "black",
        lineWidth: 5,
        lineCap: "round",
      };

      canvas.width = canvasConfig.width;
      canvas.height = canvasConfig.height;

      function draw(e) {
        if (e.buttons !== 1) return;

        if (localState.isDrawing === false) {
          localState.isDrawing = true;
          localState.lastX = e.offsetX;
          localState.lastY = e.offsetY;
        }

        if (localState.currentTool === "eraser") {
          ctx.clearRect(e.offsetX, e.offsetY, 15, 15);
          return;
        }

        ctx.fillStyle = "black";
        ctx.lineCap = "round";
        ctx.fillRect(e.offsetX, e.offsetY, 5, 5);
      }

      function clear() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }

      function changeTool(toolName) {
        localState.currentTool = toolName;
      }

      canvas.addEventListener("mousemove", draw);
      window.addEventListener("keydown", (e) => {
        if (e.key === "c") {
          clear();
        }
      });
    </script>
  </body>
</html>
